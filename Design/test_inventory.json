{
  "inventory_timestamp": "2024-01-01T00:00:00Z",
  "phase": "PHASE_1",
  "description": "Complete inventory of all test files requiring dtype validation and parametrization",

  "test_files_inventory": {
    "config_tests": [
      {
        "file": "tests/test_config.py",
        "test_count": 24,
        "current_dtype_handling": "explicit dtype testing",
        "needs_parametrization": true,
        "parametrization_strategy": "test multiple precision levels",
        "complex_testing_required": false,
        "priority": "high"
      }
    ],
    "runtime_tests": [
      {
        "file": "tests/test_runtime.py",
        "test_count": "unknown",
        "current_dtype_handling": "none",
        "needs_parametrization": true,
        "parametrization_strategy": "precision-aware execution testing",
        "complex_testing_required": false,
        "priority": "high"
      },
      {
        "file": "tests/test_primitives.py",
        "test_count": "unknown",
        "current_dtype_handling": "none",
        "needs_parametrization": true,
        "parametrization_strategy": "precision testing with complex support",
        "complex_testing_required": true,
        "priority": "high"
      }
    ],
    "transform_tests": [
      {
        "file": "tests/test_transform_op_contract.py",
        "test_count": "unknown",
        "current_dtype_handling": "none",
        "needs_parametrization": true,
        "parametrization_strategy": "transform precision validation",
        "complex_testing_required": false,
        "priority": "medium"
      }
    ],
    "manifold_tests": [
      {
        "file": "tests/test_manifold_adapters.py",
        "test_count": "unknown",
        "current_dtype_handling": "none",
        "needs_parametrization": true,
        "parametrization_strategy": "manifold operation precision",
        "complex_testing_required": false,
        "priority": "medium"
      }
    ],
    "analysis_tests": [
      {
        "file": "tests/test_fda_lanczos_mode.py",
        "test_count": "unknown",
        "current_dtype_handling": "none",
        "needs_parametrization": true,
        "parametrization_strategy": "FDA analysis precision",
        "complex_testing_required": false,
        "priority": "medium"
      },
      {
        "file": "tests/test_lanczos_contract.py",
        "test_count": "unknown",
        "current_dtype_handling": "none",
        "needs_parametrization": true,
        "parametrization_strategy": "lanczos algorithm precision",
        "complex_testing_required": false,
        "priority": "medium"
      },
      {
        "file": "tests/test_w_space_compiler.py",
        "test_count": "unknown",
        "current_dtype_handling": "none",
        "needs_parametrization": true,
        "parametrization_strategy": "W-space compilation precision",
        "complex_testing_required": false,
        "priority": "medium"
      },
      {
        "file": "tests/test_lens_probe.py",
        "test_count": "unknown",
        "current_dtype_handling": "none",
        "needs_parametrization": true,
        "parametrization_strategy": "lens probe precision",
        "complex_testing_required": false,
        "priority": "low"
      }
    ]
  },

  "parametrization_patterns": {
    "precision_levels": [
      {"name": "float32", "tolerance": "1e-5", "use_case": "memory_constrained"},
      {"name": "float64", "tolerance": "1e-12", "use_case": "numerical_stability"},
      {"name": "complex64", "tolerance": "1e-5", "use_case": "fourier_memory"},
      {"name": "complex128", "tolerance": "1e-12", "use_case": "fourier_accuracy"}
    ],
    "test_categories": [
      {
        "category": "unit_tests",
        "pattern": "@pytest.mark.parametrize('dtype', [jnp.float32, jnp.float64])",
        "scope": "individual function tests",
        "validation": "mathematical correctness within tolerance"
      },
      {
        "category": "integration_tests",
        "pattern": "@pytest.mark.parametrize('precision', ['float32', 'float64'])",
        "scope": "end-to-end pipeline tests",
        "validation": "pipeline consistency"
      },
      {
        "category": "complex_tests",
        "pattern": "@pytest.mark.parametrize('dtype', [jnp.complex64, jnp.complex128])",
        "scope": "fourier and wavelet operations",
        "validation": "complex operation accuracy"
      }
    ]
  },

  "test_fixtures_needed": {
    "dtype_fixtures": [
      {
        "fixture_name": "precision_config",
        "purpose": "Configure JAX precision for test session",
        "scope": "session",
        "implementation": "Call configure_jax_environment() with appropriate settings"
      },
      {
        "fixture_name": "test_dtypes",
        "purpose": "Provide parametrized dtype values",
        "scope": "function",
        "implementation": "Return appropriate dtype based on test requirements"
      }
    ],
    "conftest_py_updates": [
      "Add session-scoped JAX configuration fixture",
      "Add dtype parametrization utilities",
      "Import config module functions"
    ]
  },

  "complex_testing_requirements": {
    "files_requiring_complex_tests": [
      "tests/test_primitives.py"
    ],
    "complex_operations_to_test": [
      "wavelet transforms (jaxwt)",
      "Fourier transforms (potential)",
      "complex coefficient handling"
    ],
    "validation_approach": [
      "Test with both complex64 and complex128",
      "Verify mathematical correctness",
      "Check memory usage patterns",
      "Validate against real-valued equivalents where applicable"
    ]
  },

  "implementation_plan": {
    "phase_1": "Update conftest.py with JAX configuration fixtures",
    "phase_2": "Add dtype parametrization to high-priority test files",
    "phase_3": "Implement complex number testing for wavelet operations",
    "phase_4": "Add precision validation to remaining test files",
    "phase_5": "Run full precision matrix testing"
  },

  "estimated_effort": {
    "conftest_updates": "2-3 hours",
    "high_priority_parametrization": "4-6 hours",
    "complex_testing": "2-3 hours",
    "remaining_tests": "4-6 hours",
    "validation_testing": "2-3 hours",
    "total": "14-21 hours"
  },

  "success_criteria": [
    "All test files support multiple precision levels",
    "Complex operations tested with appropriate precision",
    "No dtype-related test failures",
    "Test execution time acceptable",
    "Memory usage within reasonable bounds"
  ]
}